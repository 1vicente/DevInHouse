-- Ex 1
CREATE table professores (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME VARCHAR(128) NOT NULL,
    SOBRENOME VARCHAR(128) NOT NULL,
    ENDERECO VARCHAR(500),
    TELEFONE VARCHAR(128),
    EMAIL VARCHAR(128),
    DATANASCIMENTO DATE,
    NASCIONALIDADE VARCHAR(128),
    PRIMARY KEY(ID)
);

CREATE TABLE ESTUDANTES (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME VARCHAR(128) NOT NULL,
    SOBRENOME VARCHAR(128) NOT NULL,
    MATRICULA VARCHAR(64),
    EMAIL VARCHAR(128),
    DATANASCIMENTO DATE,
    NASCIONALIDADE VARCHAR(128),
    MEDIA_GERAL NUMBER(4,2),
    PRIMARY KEY(ID)
)

CREATE TABLE CURSOS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    CODIGO NUMBER NOT NULL,
    NOME VARCHAR(128) NOT NULL,
    PRESENCIAL CHAR(1),
    ID_PROFESSOR NUMBER NOT NULL,
    NRO_MAX_ALUNOS NUMBER(32),
    PRIMARY KEY(ID),
    FOREIGN KEY(ID_PROFESSOR) REFERENCES PROFESSORES(ID)
)

-- eX2

CREATE TABLE MATRICULA (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    ID_ESTUDANTE NUMBER NOT NULL,
    ID_CURSO NUMBER NOT NULL,
    MEDIA_ESTUDANTE NUMBER(32) NOT NULL,
    PRIMARY KEY(ID),
    FOREIGN KEY(ID_ESTUDANTE) REFERENCES ESTUDANTES(ID),
    FOREIGN KEY(ID_CURSO) REFERENCES CURSOS(ID)
)

-- EX 3
--Feito previamente

-- EX 4

-- professores
INSERT INTO professores (nome, sobrenome, endereco, telefone, email, datanascimento, nascionalidade) 
    VALUES ('Vicente', 'Neto', 'São José - SC', '99099909', 'vicente@neto.com.br','17/JAN/1994','Brasileiro');

INSERT INTO professores (nome, sobrenome, endereco, telefone, email, datanascimento, nascionalidade) 
    VALUES ('Camila', 'Vicente', 'Bosque das masões - SC', '111111111', 'camila@vicente.com.br','22/FEB/1995','Brasileiro');

INSERT INTO professores (nome, sobrenome, endereco, telefone, email, datanascimento, nascionalidade) 
    VALUES ('Walerio', 'Barros', 'Florianopolis - SC', '33333333', 'barros@walerio.com.br','09/FEB/1304','EUA');

INSERT INTO professores (nome, sobrenome, endereco, telefone, email, datanascimento, nascionalidade) 
    VALUES ('Walerio', 'Barros', 'Florianopolis - SC', '33333333', 'barros@walerio.com.br','22/FEB/1999','EUA');

-- Estudantes    
INSERT INTO ESTUDANTES (nome, sobrenome, matricula, email, datanascimento)
	VALUES ('Vicente', 'Aluno', '123', 'vicente@aluno.com.br', '30/JAN/1994');

INSERT INTO ESTUDANTES (nome, sobrenome, matricula, email, datanascimento)
	VALUES ('Brenda', 'Sophia', '321', 'brenda@sofia.com.br', '16/MAR/1974');

INSERT INTO ESTUDANTES (nome, sobrenome, matricula, email, datanascimento)
	VALUES ('Yago', 'Rocha', '674', 'yago@rocha.com.br', '11/APR/1964');

INSERT INTO ESTUDANTES (nome, sobrenome, matricula, email, datanascimento)
	VALUES ('Benedita', 'Pinto', '987', 'benedita@pinto.com.br', '22/JAN/1980');

INSERT INTO ESTUDANTES (nome, sobrenome, matricula, email, datanascimento)
	VALUES ('Renato', 'Monteiro', '765', 'renato@monteiro.com.br', '25/JAN/1979');

-- Cursos
CREATE TABLE CURSOS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    CODIGO NUMBER NOT NULL,
    NOME VARCHAR(128) NOT NULL,
    PRESENCIAL CHAR(1),
    ID_PROFESSOR NUMBER NOT NULL,
    NRO_MAX_ALUNOS NUMBER(32),
    PRIMARY KEY(ID),
    FOREIGN KEY(ID_PROFESSOR) REFERENCES PROFESSORES(ID)
)
INSERT INTO CURSOS (codigo, nome, presencial, id_professor, nro_max_alunos)
	VALUES ('333', 'Java', '0', '30', '30');
    
INSERT INTO CURSOS (codigo, nome, presencial, id_professor, nro_max_alunos)
	VALUES ('444', 'Spring', '1', '29', '99');
    
INSERT INTO CURSOS (codigo, nome, presencial, id_professor, nro_max_alunos)
	VALUES ('555', 'JavaScript', '0', '31', '30');
    
INSERT INTO CURSOS (codigo, nome, presencial, id_professor, nro_max_alunos)
	VALUES ('666', 'Angular', '1', '32', '99');

-- matricula

INSERT INTO MATRICULA (id_estudante, id_curso, media_estudante)
	VALUES (1, 5, 7);
INSERT INTO MATRICULA (id_estudante, id_curso, media_estudante)
	VALUES (2, 25, 10);
INSERT INTO MATRICULA (id_estudante, id_curso, media_estudante)
	VALUES (3, 6, 3);
INSERT INTO MATRICULA (id_estudante, id_curso, media_estudante)
	VALUES (4, 7, 8);
INSERT INTO MATRICULA (id_estudante, id_curso, media_estudante)
	VALUES (5, 5, 9.5);

commit;

select * from CURSOS;

-- Ex 5

UPDATE ESTUDANTES SET MEDIA_GERAL = 3 WHERE ID = 1;
COMMIT;

UPDATE CURSOS SET PRESENCIAL = '0'
	WHERE ID_PROFESSOR IN (SELECT ID FROM PROFESSORES WHERE NASCIONALIDADE = 'EUA');

-- Ex 6
SELECT CODIGO, NOME, NRO_MAX_ALUNOS AS Maximo_Estudantes FROM CURSOS
	WHERE NRO_MAX_ALUNOS > 30;

SELECT * FROM PROFESSORES
	WHERE NASCIONALIDADE <> 'Brasileiro';

SELECT NOME FROM ESTUDANTES
	WHERE NOME LIKE 'V%';

SELECT NOME AS Estudante, MEDIA_GERAL as Media FROM ESTUDANTES
    WHERE MEDIA_GERAL > 7
	ORDER BY Media DESC;

SELECT C.CODIGO, C.NOME, P.NOME, P.SOBRENOME FROM CURSOS C
	JOIN PROFESSORES P
	ON C.ID_PROFESSOR = P.ID
	WHERE P.NOME = 'Camila';

SELECT * FROM MATRICULA M
	LEFT JOIN ESTUDANTES E
	ON M.ID_ESTUDANTE = E.ID
	RIGHT JOIN CURSOS C
	ON M.ID_CURSO = C.ID
	WHERE C.PRESENCIAL = '0';